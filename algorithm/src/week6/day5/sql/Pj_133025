select h.FLAVOR
from FIRST_HALF h
inner join ICECREAM_INFO i
on i.FLAVOR = h.FLAVOR
where i.INGREDIENT_TYPE LIKE '%fruit_based%'
and h.TOTAL_ORDER > 3000
group by i.FLAVOR
order by h.TOTAL_ORDER desc;